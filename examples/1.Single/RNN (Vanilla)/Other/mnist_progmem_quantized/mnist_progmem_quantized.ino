/*
  Trained via Tensorflow: 22 epochs | 472 parameters (bytes)
  Testing  accuracy: 0.9216 - loss: 0.2626
  Training accuracy: 0.9186 - loss: 0.2724

  Source: https://github.com/GiorgosXou/ATTiny85-MNIST-RNN-EEPROM
*/

#define NumberOf(arg) ((unsigned int) (sizeof (arg) / sizeof (arg [0]))) // calculates the number of layers (in this case 3)
#define _1_OPTIMIZE 0B11011010 // https://github.com/GiorgosXou/NeuralNetworks#define-macro-properties
#define _2_OPTIMIZE 0B00100100 // MULTIPLE_BIASES_PER_LAYER + int8_t quantization
#define Q_FLOAT_RANGE 2.0      // Our Float32 weights are in the range of [-1,1]
#define USE_RNN__NB            // Makes (vanilla)-RNN the core-architecture of your NeuralNetwork. (NB = NO_BACKPROP support)
#define SELU                   // Defines core activation-function of your NeuralNetwork.
#include <NeuralNetwork.h>


// Images of handwritten Numbers\Digits in byte form. 
const PROGMEM byte handwritten[4][28][28] = { 
{ // NUMBER: 4
    {0,0,0,0, 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,  0,  0,  0, 50,224,  0,  0,  0,  0,  0,  0,  0, 70, 29,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,  0,  0,  0,121,231,  0,  0,  0,  0,  0,  0,  0,148,168,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,  0,  0,  4,195,231,  0,  0,  0,  0,  0,  0,  0, 96,210, 11,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,  0,  0, 69,252,134,  0,  0,  0,  0,  0,  0,  0,114,252, 21,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,  0, 45,236,217, 12,  0,  0,  0,  0,  0,  0,  0,192,252, 21,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,  0,168,247, 53,  0,  0,  0,  0,  0,  0,  0, 18,255,253, 21,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0, 84,242,211,  0,  0,  0,  0,  0,  0,  0,  0,141,253,189,  5,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,169,252,106,  0,  0,  0,  0,  0,  0,  0, 32,232,250, 66,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0, 15,225,252,  0,  0,  0,  0,  0,  0,  0,  0,134,252,211,  0,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0, 22,252,164,  0,  0,  0,  0,  0,  0,  0,  0,169,252,167,  0,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  9,204,209, 18,  0,  0,  0,  0,  0,  0, 22,253,253,107,  0,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,169,252,199, 85, 85, 85, 85,129,164,195,252,252,106,  0,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0, 41,170,245,252,252,252,252,232,231,251,252,252,  9,  0,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,  0,  0, 49, 84, 84, 84, 84,  0,  0,161,252,252,  0,  0,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,127,252,252, 45,  0,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,128,253,253,  0,  0,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,127,252,252,  0,  0,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,135,252,244,  0,  0,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,232,236,111,  0,  0,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,179, 66,  0,  0,  0,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 0,0,0,0},
},
{ // NUMBER: 7
    {0,0,0,0, 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,  0,  0,  0, 38,113,113,113,114,238,253,253,253,255,206, 88,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0, 57, 85,147,234,252,252,252,253,252,252,252,252,253,252,246, 75,  0, 0,0,0,0},
    {0,0,0,0, 0, 67,197,234,252,253,252,252,252,252,196,195,195,195,195,253,252,252, 84,  0, 0,0,0,0},
    {0,0,0,0, 0, 85,252,252,252,225,223,114, 84, 84,  0,  0,  0,  0, 16,253,252,214, 28,  0, 0,0,0,0},
    {0,0,0,0, 0, 38,221,157,112,  0,  0,  0,  0,  0,  0,  0,  0, 16,203,253,252,118,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 26,207,253,255,168,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,104,252,252,215, 33,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 67,240,252,220, 31,  0,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 29,181,252,217, 37,  0,  0,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,253,252,252, 84,  0,  0,  0,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,  0,  0,  0,  0,  0, 76,191,255,215,110,  0,  0,  0,  0,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,  0,  0,  0,  0, 19,196,252,253,121,  0,  0,  0,  0,  0,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,  0,  0,  0, 67,209,252,252, 56,  6,  0,  0,  0,  0,  0,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,  0,  0, 29,181,252,217, 84,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,  0,  0,253,252,252, 84,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0, 13,191,255,215, 31,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,154,252,253,121,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0, 13,187,252,133,  6,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0, 57,252,252,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0, 57,252,252,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 0,0,0,0},  
},
{ // NUMBER: 0
    {0,0,0,0, 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 0,0,0,0,},
    {0,0,0,0, 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 0,0,0,0,},
    {0,0,0,0, 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 0,0,0,0,},
    {0,0,0,0, 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 0,0,0,0,},
    {0,0,0,0, 0,  0,  0,  0,  0,  0,  0, 61,  3, 42,118,193,118,118, 61,  0,  0,  0,  0,  0, 0,0,0,0,},
    {0,0,0,0, 0,  0,  0,  0,  0, 14,179,245,236,242,254,254,254,254,245,235, 84,  0,  0,  0, 0,0,0,0,},
    {0,0,0,0, 0,  0,  0,  0,  0,151,254,254,254,213,192,178,178,180,254,254,241, 46,  0,  0, 0,0,0,0,},
    {0,0,0,0, 0,  0,  0,  0, 43,235,254,226, 64, 28, 12,  0,  0,  2,128,252,255,173, 17,  0, 0,0,0,0,},
    {0,0,0,0, 0,  0,  0,  0, 56,254,253,107,  0,  0,  0,  0,  0,  0,  0,134,250,254, 75,  0, 0,0,0,0,},
    {0,0,0,0, 0,  0,  0,  0, 63,254,158,  0,  0,  0,  0,  0,  0,  0,  0,  0,221,254,157,  0, 0,0,0,0,},
    {0,0,0,0, 0,  0,  0,  0,194,254,103,  0,  0,  0,  0,  0,  0,  0,  0,  0,150,254,213,  0, 0,0,0,0,},
    {0,0,0,0, 0,  0,  0, 34,220,239, 58,  0,  0,  0,  0,  0,  0,  0,  0,  0, 84,254,213,  0, 0,0,0,0,},
    {0,0,0,0, 0,  0,  0,126,254,171,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 84,254,213,  0, 0,0,0,0,},
    {0,0,0,0, 0,  0,  0,214,239, 60,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 84,254,213,  0, 0,0,0,0,},
    {0,0,0,0, 0,  0,  0,214,199,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 84,254,213,  0, 0,0,0,0,},
    {0,0,0,0, 0,  0, 11,219,199,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 84,254,213,  0, 0,0,0,0,},
    {0,0,0,0, 0,  0, 98,254,199,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,162,254,209,  0, 0,0,0,0,},
    {0,0,0,0, 0,  0, 98,254,199,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 51,238,254, 75,  0, 0,0,0,0,},
    {0,0,0,0, 0,  0, 98,254,199,  0,  0,  0,  0,  0,  0,  0,  0,  0, 51,165,254,195,  4,  0, 0,0,0,0,},
    {0,0,0,0, 0,  0, 66,241,199,  0,  0,  0,  0,  0,  0,  0,  0,  3,167,254,227, 55,  0,  0, 0,0,0,0,},
    {0,0,0,0, 0,  0,  0,214,213, 20,  0,  0,  0,  0,  0, 46,152,202,254,254, 63,  0,  0,  0, 0,0,0,0,},
    {0,0,0,0, 0,  0,  0,214,254,204,180,180,180,180,180,235,254,254,234,156, 10,  0,  0,  0, 0,0,0,0,},
    {0,0,0,0, 0,  0,  0, 81,205,254,254,254,254,254,254,254,252,234,120,  0,  0,  0,  0,  0, 0,0,0,0,},
    {0,0,0,0, 0,  0,  0,  0, 26,210,254,254,254,254,254,153,104,  0,  0,  0,  0,  0,  0,  0, 0,0,0,0,},
    {0,0,0,0, 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 0,0,0,0,},
    {0,0,0,0, 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 0,0,0,0,},
    {0,0,0,0, 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 0,0,0,0,},
    {0,0,0,0, 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 0,0,0,0,}
},
{ // NUMBER: 3
    {0,0,0,0, 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0, 67,128,188,254,254,255,254,254,181,123, 38,  3,  0,  0,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0, 94,249,251,202,136, 88, 89,136,136,160,230,253,186, 21,  0,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0, 22,235,193, 60,  0,  0,  0,  0,  0,  0,  0, 15, 99,214,205,  0,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0, 88,235, 19,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 65,253, 49,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0, 25,121,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  5,236, 79,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,107,253, 43,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,118,247,174,  0,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 49,211,249,144,  8,  0,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,  0,  2, 20, 62, 98,152,175,242,254,211, 85,  0,  0,  0,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,  0, 20,253,253,253,254,253,253,253,207, 57,  6,  0,  0,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,  0,  9,117,117,117, 63, 51,117,140,236,253,220, 95,  0,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 14, 92,241,253,229, 60,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,121,248,230, 51,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 53,244,203,  3, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,153,253, 19, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,141,253, 19, 0,0,0,0},
    {0,0,0,0, 0,13,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,   5, 44,134,254,189,  0, 0,0,0,0},
    {0,0,0,0,16,231,112, 40, 25,  0,  0,  0,  0,  0,  0, 25, 40,100,197,253,208,125, 27,  0, 0,0,0,0},
    {0,0,0,0, 3,168,253,253,239,215,172,136,191,215,215,238,254,253,253,150,  0,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  3, 62,122,175,187,229,253,254,193,175,175, 98, 97, 31,  2,  0,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 0,0,0,0},
    {0,0,0,0, 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 0,0,0,0}, 
},
}; // ^^^^^^ (images*(rows*pixels)) = (4*(28*28)) = 3136 Bytes 


const PROGMEM int8_t biases[] = {
 -9  , 21 ,-8  ,-5  , 9  ,
  17 ,-42 ,-78 ,-1  , 0  ,-4  ,-12 ,-2  ,
 -78 , 1  ,-19 ,-35 , 118, 2  , 20 ,-127,-54 ,-30 ,
};

const PROGMEM int8_t weights[] = {
  // Layer 0 -> 1
  114, 38 ,-100, 5  ,-4  , 11 , 21 , 17 , 21 , 27 , 29 , 39 , 32 , 69, 48 , 56 , 22 , 16 , 12 , 1  , 11 ,-4  , 2  , 24 , 5  ,-20 , 41 ,-51 ,
  58 , 21 ,-57 ,-15 ,-14 ,
 -58 ,-6  , 4  ,-11 , 45 ,-4  ,-10 ,-15 ,-28 ,-15 ,-38 ,-25 , 25 ,-5 ,-3  ,-14 , 28 , 28 , 15 , 19 ,-1  ,-4  , 6  ,-46 ,-1  , 18 , 53 , 58 ,
  79 ,-35 , 33 , 11 , 5  ,
 -126,-21 , 76 , 19 ,-90 ,-69 ,-45 ,-67 ,-65 ,-63 ,-60 ,-32 ,-68 , 2 ,-3  , 29 ,-8  ,-24 ,-13 ,-27 ,-4  ,-17 ,-14 , 10 ,-18 ,-16 , 30 ,-26 ,
  2  , 102,-30 ,-40 , 83 ,
 -65 , 1  , 16 ,-71 , 16 ,-19 , 20 , 10 , 9  , 35 , 35 , 74 , 77 , 88, 54 , 37 , 45 , 34 , 5  , 9  ,-6  ,-2  , 3  ,-11 , 9  , 62 , 118, 79 ,
 -85 ,-56 , 21 ,-3  , 18 ,
 -43 ,-18 , 8  ,-125,-92 ,-39 ,-30 ,-32 ,-16 ,-34 ,-12 ,-24 ,-51 , 6 , 11 , 43 ,-14 ,-11 ,-15 ,-20 , 0  , 5  ,-2  , 53 , 8  , 21 ,-11 ,-34 ,
  29 ,-14 ,-64 ,-42 ,-97 ,

  // Layer 1 -> 2
 -18 , 49 , 92 , 40 ,-74 ,
  37 , 116, 36 , 47 ,-43 ,-34 , 14 ,-4  ,
 -117, 6  , 110,-125, 32 ,
 -36 ,-91 , 14 ,-13 , 53 , 13 , 17 , 6  ,
  64 ,-21 , 5  ,-27 ,-127,
 -8  , 41 , 1  , 13 , 49 , 34 ,-90 ,-10 ,
 -106,-58 ,-52 ,-4  ,-27 ,
  41 , 115,-54 , 28 ,-29 , 6  ,-26 ,-35 ,
  84 ,-21 , 34 , 16 ,-82 ,
  58 ,-86 , 20 , 3  , 50 , 25 ,-42 ,-46 ,
 -44 ,-100, 28 , 28 ,-7  ,
 -77 ,-60 ,-34 ,-14 , 124, 58 , 38 , 8  ,
  5  ,-37 ,-74 ,-24 ,-64 ,
  78 , 12 , 2  ,-58 , 8  , 51 , 61 , 24 ,
  8  ,-76 , 29 , 56 , 32 ,
 -69 ,-18 , 36 ,-55 , 59 ,-49 , 29 , 94 ,

  // Layer 2 -> 3
 -62 ,-20 , 86 ,-74 ,-24 , 1  , 1  ,-15 ,
  114, 19 ,-29 , 38 , 24 , 0  , 6  ,-18 , 65 ,-33 ,
 -74 , 74 ,-29 , 34 ,-93 ,-107,-50 , 38 ,
 -2  , 109,-4  ,-30 , 14 , 53 ,-66 ,-47 , 20 , 1  ,
 -34 , 2  ,-3  , 6  , 4  , 6  ,-12 ,-18 ,
 -1  , 4  , 122,-18 ,-22 , 30 , 4  , 7  , 25 , 10 ,
 -3  , 111, 31 , 41 ,-28 , 18 , 100, 29 ,
 -30 , 15 , 44 , 44 , 31 , 53 ,-10 , 4  ,-2  ,-8  ,
  6  ,-48 ,-5  , 20 ,-51 ,-70 ,-25 , 23 ,
 -32 ,-45 , 29 , 19 , 81 ,-8  , 22 ,-15 ,-57 , 16 ,
  0  , 34 , 46 , 30 , 36 , 36 , 66 ,-10 ,
  2  ,-10 ,-42 , 32 , 15 , 87 ,-21 ,-1  ,-23 , 10 ,
 -99 , 27 ,-56 , 27 ,-5  , 23 , 72 ,-54 ,
  10 , 8  ,-4  , 3  , 8  ,-29 , 59 ,-31 , 11 , 9  ,
 -95 ,-12 , 2  ,-1  ,-49 ,-109,-10 , 24 ,
  16 ,-15 , 6  , 29 , 11 , 17 ,-63 , 69 ,-32 , 18 ,
  30 , 68 ,-14 , 91 , 29 ,-44 , 20 , 62 ,
 -29 ,-9  ,-28 , 9  ,-17 ,-6  ,-2  , 23 , 77 , 27 ,
 -48 , 79 , 38 , 18 ,-32 ,-74 , 57 ,-11 ,
  18 , 19 , 38 ,-55 , 34 , 59 ,-1  , 10 ,-63 , 76 ,
};

const unsigned int layers[] = {28, 5, 8, 10};
float *output; // 4th layer's output(s)

unsigned long timestamp;


unsigned int maxOutput(){
  unsigned int maxi=0;
  for (unsigned int i = 0; i < 10; i++)
    if (output[i] > output[maxi])
      maxi = i;
  return maxi;
}


void setup()
{
  Serial.begin(9600);
  while (!Serial){ };

  // Creating a NeuralNetwork with pretrained Weights and Biases
  NeuralNetwork NN(layers, weights, biases, NumberOf(layers));
  //Goes through each image
  for (unsigned int image = 0; image < 4; image++){
    timestamp = millis();  
    // Goes through each row (total of [28-Rows * 28-Pixel])     
    for (unsigned int row = 0; row < 28; row++){
      // Feedfowards individually each pixel of an image, and then: returns the output(s).
      for (unsigned int pixel=0; pixel < 28;  pixel++){
        output = NN.FeedForward_Individual(pgm_read_byte(&handwritten[image][row][pixel]) / 255.0); // (255 is used to normalize pixels between [0,1])
      }
    }
    // Prints the most probable Output (maxOutput) and afterwards it resets the internal hidden-states of the RNN (resetStates) for the next image
    Serial.println((String)"Predicted [" + (maxOutput()) + "] - Under " + (millis() - timestamp) + " milliseconds.");
    NN.resetStates();
  }
}
void loop(){}



